# SaihAI 機能要件

本書は、マネージャーが利用する UI/UX と、それを支えるバックエンドロジックの 2 部構成で機能要件をまとめる。各セクションはユーザーの期待する体験とシステム側の動作を対応づけて記述する。

## 1. UI/UX 要件（Frontend / Interface）

### 1-1. Web ダッシュボード（分析用）
- **技術スタック:** Angular ベースの管理画面。
- **目的:** 深い分析や複雑なシミュレーション結果の可視化を行い、マネージャーがチーム構成を検討しやすくする。
- **機能カテゴリと要件:**
  - **初期表示（Dashboard Load）**
    - 起動時に初期表示用データを一括取得し、アラート/診断/提案/承認待ちを即時に表示する。
    - 詳細: `requirement/initial-display.md`
  - **プロジェクト・メンバー可視化**
    - 現在のプロジェクト体制図とメンバー一覧を表示する。
    - メンバーの「Genome（ゲノム）」詳細（スキル、モチベーション推移、キャリア志向）を表示する。
    - ドラッグ＆ドロップによる手動シミュレーション操作を提供する。
  - **リアルタイム診断・警告 UI**
    - 手動配置時にリアルタイムで予算判定と要件カバー率を表示する。
    - 「予算オーバー」「離職リスク（燃え尽き予兆）」などのリスクアラートを赤字やアイコンで強調表示する。
  - **AI 戦略提案モーダル（The Gunshi View）**
    - 「プラン A（堅実）」「プラン B（投資/挑戦）」「プラン C（コスト重視）」の 3 戦略を並列提示する。
    - 推奨プランに「AI 推奨バッジ」や「ドリームマッチ」エフェクトを表示する。
    - 各プランのメリット・デメリット（トレードオフ）をテキストで示す。
  - **未来予測グラフ**
    - 選択したプラン実行時の 3 ヶ月後のチーム力や予算推移を予測グラフとして表示する。

### 1-2. Slack / Chat インターフェース（通知・承認用）
- **目的:** AI が能動的に通知し、人間の承認や介入を受け付けるコミュニケーションレイヤー。
- **機能カテゴリと要件:**
  - **プッシュ通知（Shadow Monitoring）**
    - 異常検知結果（例: 「〇〇さんに燃え尽きの兆候あり」）を能動的に通知する。
    - AI が作成したアクション案（メール下書き等）を提示し、承認依頼として通知する。
  - **インタラクティブ・アクション**
    - ワンクリック承認（Approve）で、AI が準備したメール送信や申請を即時実行できる。
    - チャットでの自然言語指示（例: 「メールは来週にして」）を受け付け、AI プランを修正する。

## 2. バックエンド機能要件（Backend / Logic）

### 2-1. コア・ロジック（LangGraph / Python）
- **役割:** 思考・判断・記憶を担うマルチエージェントシステム。
- **エージェント種別と要件:**
  - **Orchestrator（Gunshi Agent）**
    - HR、PM、Risk などの専門エージェントへ指令を出す司令塔・調停役。
    - 利益と感情など相反する意見を調停するロジックを持つ。
    - 3 つの戦略シナリオ（松・竹・梅）を合成・生成する。
  - **Specialist Agents（専門家群）**
    - **HR Agent:** 週報など非構造化データからモチベーションやキャリア志向を解析する。
    - **PM Agent:** スキル適合率や予算消化率を計算する。
    - **Risk Agent:** 過去データを基に離職確率や炎上リスクを予測する。
  - **Auto-Nemawashi（根回し実行）**
    - **Drafting Agent:** 状況に応じたメール文面（クライアント連絡、メンバー面談招待など）を自動生成する。
    - **Calendar Agent:** カレンダー API 連携で日程調整や仮押さえを行う（モックまたは実 API 連携を想定）。
  - **Human-in-the-loop (HITL) 制御**
    - **Checkpoint & Interrupt:** AI の実行プロセスを「承認待ち」で一時停止できる。
    - **State Persistence:** 介入待ちの計算状態を DB（PostgreSQL / langgraph_checkpoints）に保持し、指示を受けて再開（Resume）できる。

### 2-2. データ処理・インフラ（Data & Infrastructure）
- **役割:** 直感的な判断材料をデータ化し、継続的に解析を回す基盤。
- **機能カテゴリと要件:**
  - **Watchdog Trigger（常時監視）**
    - Cron や EventBridge による定期実行トリガーで、ユーザーがログインしていなくてもバックグラウンドで解析を実行する。
  - **Genome 解析・RAG 基盤**
    - Vector DB（Pinecone/pgvector など）に週報、面談ログ、Slack ログ等の非構造化データをベクトル化して保存する。
    - Semantic Search で「疲れている」「新しいことに挑戦したい」といったニュアンス検索を可能にする。
  - **データ統合管理**
    - PostgreSQL で社員マスタ、案件マスタ、勤怠データを管理する。
